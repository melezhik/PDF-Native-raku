all : resources/lib/libpdf%SO% %FAKESO%
	@echo done

resources/lib/libpdf%SO% :
	(cd src/libpdf && $(MAKE) all) \
	&& install src/libpdf/libpdf%SO% resources/lib/

coverage :
	export COVERAGE=1;\
	$(MAKE) clean test;\
	cd src/libpdf && $(MAKE) coverage

test : all
	@prove -e'perl6 -I lib' -v t

memtest : all
	@prove -e'perl6-valgrind-m -I lib' -v t

clean :
	(cd src/libpdf && $(MAKE) $@) \
	&& rm -f resources/lib/libpdf.dll resources/lib/libpdf.dylib resources/lib/libpdf.so

